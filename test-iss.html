<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ISS Module Test</title>
    <style>
        body {
            background: #1a1a1a;
            color: #fff;
            font-family: monospace;
            padding: 20px;
        }
        .status { padding: 10px; margin: 5px 0; border-radius: 4px; }
        .success { background: #2d5016; border-left: 4px solid #4caf50; }
        .error { background: #5c1616; border-left: 4px solid #f44336; }
        .info { background: #1a3d5c; border-left: 4px solid #2196f3; }
    </style>
</head>
<body>
    <h1>üõ∞Ô∏è ISS Module Test</h1>
    <div id="output"></div>

    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r160/three.min.js"></script>

    <script type="module">
        const output = document.getElementById('output');

        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `status ${type}`;
            div.textContent = message;
            output.appendChild(div);
        }

        log('Starting ISS module test...', 'info');

        try {
            // Test 1: Import ISS API
            log('Test 1: Importing ISS API...', 'info');
            const apiModule = await import('./src/utils/api.js');
            log('‚úÖ API module loaded successfully', 'success');

            // Test 2: Import coordinates
            log('Test 2: Importing coordinates module...', 'info');
            const coordsModule = await import('./src/utils/coordinates.js');
            log('‚úÖ Coordinates module loaded successfully', 'success');

            // Test 3: Import constants
            log('Test 3: Importing constants...', 'info');
            const constantsModule = await import('./src/utils/constants.js');
            log('‚úÖ Constants loaded successfully', 'success');

            // Test 4: Fetch ISS position
            log('Test 4: Fetching ISS position from API...', 'info');
            const position = await apiModule.issAPI.fetchISSPosition();
            log(`‚úÖ ISS Position: ${position.latitude.toFixed(2)}¬∞, ${position.longitude.toFixed(2)}¬∞`, 'success');
            if (position.isMock) {
                log('‚ö†Ô∏è Using mock data (API unavailable)', 'info');
            }

            // Test 5: Convert to 3D coordinates
            log('Test 5: Converting to 3D coordinates...', 'info');
            const scenePos = coordsModule.geographicToScenePosition(
                position.latitude,
                position.longitude,
                constantsModule.ISS_ORBIT_ALTITUDE
            );
            log(`‚úÖ 3D Position: x=${scenePos.x.toFixed(2)}, y=${scenePos.y.toFixed(2)}, z=${scenePos.z.toFixed(2)}`, 'success');

            // Test 6: Try to import ISS module
            log('Test 6: Importing ISS module...', 'info');
            const issModule = await import('./src/modules/iss.js');
            log('‚úÖ ISS module loaded successfully', 'success');

            log('üéâ All tests passed! ISS module is working correctly.', 'success');

        } catch (error) {
            log(`‚ùå Error: ${error.message}`, 'error');
            log(`Stack: ${error.stack}`, 'error');
        }
    </script>
</body>
</html>
